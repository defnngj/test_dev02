{% extends "base.html" %}
{% block base %}

<nav class="navbar navbar-inverse navbar-fixed-top">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
				aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="#">接口测试平台</a>
		</div>
		<div id="navbar" class="navbar-collapse collapse">
			<ul class="nav navbar-nav navbar-right">
				<li><a href="#">Settings</a></li>
				<li><a href="/logout/">logout</a></li>
			</ul>
			<form class="navbar-form navbar-right">
				<input type="text" class="form-control" placeholder="Search...">
			</form>
		</div>
	</div>
</nav>

<div class="container-fluid">
	<div class="row">
		<div class="col-sm-3 col-md-2 sidebar">
			<ul class="nav nav-sidebar">
				<li>
					<a href="/project/">
						<i class="glyphicon glyphicon-th-large"></i>&nbsp&nbsp项目管理
					</a>
				</li>
				<li>
					<a href="/module/">
						<i class="glyphicon glyphicon-th"></i>&nbsp&nbsp模块管理
					</a>
				</li>
			</ul>
			<ul class="nav nav-sidebar">
				<li class="active"><a href="/testcase/">用例管理</a></li>
				<li><a href="">任务管理</a></li>
			</ul>
			<ul class="nav nav-sidebar">
				<li><a href="">mock Server</a></li>
				<li><a href="">测试工具</a></li>
			</ul>
		</div>
		<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">


		<!--模块列表-->
      {% if type == "debug" %}
      <h4 class="sub-header">postman
      </h4>
      <!--<div class="table-responsive">-->
            <div class="input-group">
                <span class="input-group-addon">* URL</span>
                <input id="req_url" type="text" class="form-control" placeholder="url">
            </div>

          <br>
            <div>
                <label>* 请求方法：</label>
                <label class="radio-inline">
                    <input type="radio" name="req_method" id="get" value="get" checked> GET
                </label>
                <label class="radio-inline">
                    <input type="radio" name="req_method" id="post" value="post"> POST
                </label>
                <label class="radio-inline">
                    <input type="radio" name="req_method" id="put" value="put"> PUT
                </label>
                 <label class="radio-inline">
                    <input type="radio" name="req_method" id="delete" value="delete"> DELETE
                </label>
            </div>

            <div class="input-group">
                <span class="input-group-addon">header</span>
                <input id="header" type="text" class="form-control" placeholder="header">
            </div>

            <div style="margin-top: 10px;">
                <label>* 参数类型：</label>
                <label class="radio-inline">
                    <input type="radio" name="par_type" id="from" value="from" checked> form-data
                </label>
                <label class="radio-inline">
                    <input type="radio" name="par_type" id="json" value="json"> JSON
                </label>
            </div>

            <div class="input-group">
                <span class="input-group-addon">参数</span>
                <input id="parameter" type="text" class="form-control">
            </div>
            <p style="color:#8B8989">说明：以字典的方式设置参数，如：{"id":1, "name":"名称"}</p>

            <div style="float: right;margin-right: 10px;">
            <button type="button" class="btn btn-primary" onclick="jsFun()">发送</button>
            </div>

            <div style="margin-top: 30px;">
                <p>返回结果：</p>
                <textarea id="result" class="form-control" rows="10" name=textarea></textarea>
            </div>

      <!--</div>-->
      {% endif %}


		</div>
	</div>
</div>

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
    function jsFun(){
        var url = $("#req_url").val();;
        var moethd = $('input[name="req_method"]:checked').val();
        var header = $("#header").val();
        var type = $('input[name="par_type"]:checked').val();
        var parameter = $("#parameter").val();

        if(url === ""){
            window.alert("URL不能为空！");
            return;
        }
        window.alert("parameter:"+parameter);

        $.post("/testcase/debug",
        {
            url: url,
            moethd: moethd,
            header: header,
            type: type,
            parameter: parameter,
        },
        function (data, status) {
            alert("数据：" + data.result);
            console.log("返回的结果", data.result);
            document.querySelector("#result").value = data.result;
        });
        
    };
    //

</script>
{% endblock %}